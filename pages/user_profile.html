<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - Elevate Realty</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="../css/custom_styles.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        h1, h2, h3, h4, h5, h6 { font-family: 'Montserrat', sans-serif; }
        .text-primary { color: #1a237e; } /* Indigo */
        .btn-primary { background-color: #1a237e; color: white; padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 500; transition: background-color 0.3s ease; }
        .btn-primary:hover { background-color: #283593; }
        .btn-secondary-outline { border: 1px solid #1a237e; color: #1a237e; padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 500; transition: all 0.3s ease; }
        .btn-secondary-outline:hover { background-color: #1a237e; color: white; }
        .card-elevated { background-color: white; border-radius: 0.75rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
        .input-field { border: 1px solid #cbd5e0; border-radius: 0.5rem; padding: 0.75rem 1rem; width: 100%; transition: border-color 0.3s ease, box-shadow 0.3s ease; }
        .input-field:focus { border-color: #1a237e; box-shadow: 0 0 0 2px rgba(26, 35, 126, 0.2); outline: none; }
        .text-accent { color: #ffd700; } /* Gold */
    </style>
</head>
<body class="bg-gray-100">
    <!-- Navigation Header -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-surface/95 backdrop-blur-md border-b border-border-light">
        <nav class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <a href="homepage_3d_immersive_experience.html" class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-primary to-primary-600 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2L2 7v10c0 5.55 3.84 10 9 11 1.09-.87 2-1.76 2.71-2.71-.95-.65-1.71-1.57-1.71-2.29 0-.72.76-1.64 1.71-2.29C14.16 17 18 12.55 18 7L12 2z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-montserrat font-semibold text-primary">Elevate Realty</h1>
                        <p class="text-xs text-text-secondary">Premium Real Estate</p>
                    </div>
                </a>

                <!-- Desktop Navigation -->
                <div class="hidden lg:flex items-center space-x-8">
                    <a href="homepage_3d_immersive_experience.html" class="text-text-secondary hover:text-primary transition-smooth">Home</a>
                    <a href="property_discovery_advanced_search_hub.html" class="text-text-secondary hover:text-primary transition-smooth">Properties</a>
                    <a href="market_analytics_intelligence_hub.html" class="text-text-secondary hover:text-primary transition-smooth">Market Intel</a>
                    <a href="agent_profiles_expertise_showcase.html" class="text-text-secondary hover:text-primary transition-smooth">Agents</a>
                    <a href="about_elevate_experience.html" class="text-text-secondary hover:text-primary transition-smooth">About</a>
                    <!-- My Profile link will be handled by auth logic, so no active state here -->
                </div>

                <!-- CTA Buttons & Auth Links -->
                <div class="hidden md:flex items-center space-x-4">
                    <div id="userAuthDesktopLinks" class="flex items-center space-x-4"></div>
                    <button class="btn-secondary text-sm px-4 py-2 open-inquiry-modal-btn" data-service-type="Tour Request">Schedule Tour</button>
                    <button class="btn-primary text-sm px-4 py-2 open-inquiry-modal-btn" data-service-type="VIP Consultation">VIP Consultation</button>
                </div>

                <!-- Mobile Menu Button -->
                <button class="lg:hidden p-2 text-text-secondary hover:text-primary" id="mobileMenuBtn">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
            <!-- Mobile Menu -->
            <div class="lg:hidden hidden bg-surface border-t border-border-light" id="mobileMenu">
                <div class="pt-4 pb-2 space-y-2 px-3">
                    <a href="homepage_3d_immersive_experience.html" class="block px-3 py-2 text-text-secondary hover:text-primary transition-smooth">Home</a>
                    <a href="property_discovery_advanced_search_hub.html" class="block px-3 py-2 text-text-secondary hover:text-primary transition-smooth">Properties</a>
                    <a href="market_analytics_intelligence_hub.html" class="block px-3 py-2 text-text-secondary hover:text-primary transition-smooth">Market Intel</a>
                    <a href="agent_profiles_expertise_showcase.html" class="block px-3 py-2 text-text-secondary hover:text-primary transition-smooth">Agents</a>
                    <a href="about_elevate_experience.html" class="block px-3 py-2 text-text-secondary hover:text-primary transition-smooth">About</a>
                    <div id="userAuthMobileLinks" class="space-y-2 mb-2 pb-2 border-b border-border-light"></div>
                    <div class="pt-4 space-y-2 border-t border-border-light mt-2">
                        <button class="btn-secondary text-sm px-4 py-2 w-full open-inquiry-modal-btn" data-service-type="Tour Request">Schedule Tour</button>
                        <button class="btn-primary text-sm px-4 py-2 w-full open-inquiry-modal-btn" data-service-type="VIP Consultation">VIP Consultation</button>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="pt-24 pb-16">
        <div class="container mx-auto px-6">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-12">
                    <h1 class="text-4xl md:text-5xl font-montserrat font-semibold text-primary mb-4">My Profile</h1>
                    <p class="text-xl text-gray-600">Manage your information and preferences.</p>
                </div>

                <div class="card-elevated p-6 md:p-8 mb-8">
                    <h2 class="text-2xl font-montserrat font-semibold text-primary mb-6">Account Information</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-500">Name</label>
                            <p id="profileUserName" class="text-lg text-gray-800">-</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-500">Email</label>
                            <p id="profileUserEmail" class="text-lg text-gray-800">-</p>
                        </div>
                        <button class="btn-secondary-outline mt-4">Edit Profile (Coming Soon)</button>
                    </div>
                </div>

                <div class="card-elevated p-6 md:p-8">
                    <h2 class="text-2xl font-montserrat font-semibold text-primary mb-6">My Favorite Properties</h2>
                    <div id="favoritePropertiesContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Favorite properties will be injected here -->
                        <p class="text-gray-500 col-span-full">You haven't saved any favorite properties yet.</p>
                    </div>
                </div>
                
                <!-- Saved Searches (Optional - Future) -->
                <!--
                <div class="card-elevated p-6 md:p-8 mt-8">
                    <h2 class="text-2xl font-montserrat font-semibold text-primary mb-6">My Saved Searches</h2>
                    <div id="savedSearchesContainer">
                        <p class="text-gray-500">You haven't saved any searches yet.</p>
                    </div>
                </div>
                -->

            </div>
        </div>
    </main>

    <footer class="bg-primary text-white py-12 mt-16">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; <span id="currentYear"></span> Elevate Realty. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // User Authentication Links Management
            const userAuthDesktopLinks = document.getElementById('userAuthDesktopLinks');
            const userAuthMobileLinks = document.getElementById('userAuthMobileLinks');

            function handleLogout() {
                localStorage.removeItem('isUserLoggedIn');
                localStorage.removeItem('loggedInUserEmail');
                localStorage.removeItem('loggedInUserName');
                alert('You have been logged out.');
                updateAuthLinks();
                // Redirect to login or homepage after logout from profile page
                window.location.href = 'login.html'; 
            }

            function updateAuthLinks() {
                const isLoggedIn = localStorage.getItem('isUserLoggedIn') === 'true';
                let desktopLinksHTML = '';
                let mobileLinksHTML = '';

                if (isLoggedIn) {
                    desktopLinksHTML = `
                        <a href="user_profile.html" class="text-sm text-primary font-medium border-b-2 border-primary pb-1">My Profile</a>
                        <button id="logoutBtnDesktop" class="btn-secondary-outline text-sm px-3 py-1.5">Logout</button>
                    `;
                    mobileLinksHTML = `
                        <a href="user_profile.html" class="block px-3 py-2 text-primary font-medium">My Profile</a>
                        <button id="logoutBtnMobile" class="btn-secondary-outline text-sm px-4 py-2 w-full text-left">Logout</button>
                    `;
                } else {
                    desktopLinksHTML = `
                        <a href="login.html" class="text-sm text-text-secondary hover:text-primary transition-smooth">Login</a>
                        <a href="signup.html" class="btn-primary text-sm px-4 py-2">Sign Up</a>
                    `;
                    mobileLinksHTML = `
                        <a href="login.html" class="block px-3 py-2 text-text-secondary hover:text-primary transition-smooth">Login</a>
                        <a href="signup.html" class="block px-3 py-2 mt-1 btn-primary text-center">Sign Up</a>
                    `;
                }

                if (userAuthDesktopLinks) userAuthDesktopLinks.innerHTML = desktopLinksHTML;
                if (userAuthMobileLinks) userAuthMobileLinks.innerHTML = mobileLinksHTML;

                // Add event listeners to newly created logout buttons
                if (isLoggedIn) {
                    const logoutBtnDesktop = document.getElementById('logoutBtnDesktop');
                    const logoutBtnMobile = document.getElementById('logoutBtnMobile');
                    if (logoutBtnDesktop) logoutBtnDesktop.addEventListener('click', handleLogout);
                    if (logoutBtnMobile) logoutBtnMobile.addEventListener('click', handleLogout);
                }
            }
            updateAuthLinks();

            // Generic Inquiry Modal Logic
            const genericInquiryModal = document.getElementById('genericInquiryModal');
            const genericInquiryModalContent = document.getElementById('genericInquiryModalContent');
            const inquiryServiceNameInput = document.getElementById('inquiryServiceName');
            const closeGenericInquiryModalBtn = document.getElementById('closeGenericInquiryModalBtn');
            const genericInquiryForm = document.getElementById('genericInquiryForm');
            const openInquiryModalButtons = document.querySelectorAll('.open-inquiry-modal-btn');

            function openGenericModal(serviceType) {
                if (inquiryServiceNameInput) inquiryServiceNameInput.value = serviceType;
                if (genericInquiryModal && genericInquiryModalContent) {
                    genericInquiryModal.classList.remove('hidden');
                    setTimeout(() => { 
                        genericInquiryModal.classList.remove('opacity-0');
                        genericInquiryModalContent.classList.remove('scale-95', 'opacity-0');
                        genericInquiryModalContent.classList.add('scale-100', 'opacity-100');
                    }, 10);
                }
            }

            function closeGenericModal() {
                if (genericInquiryModal && genericInquiryModalContent) {
                    genericInquiryModalContent.classList.remove('scale-100', 'opacity-100');
                    genericInquiryModalContent.classList.add('scale-95', 'opacity-0');
                    genericInquiryModal.classList.add('opacity-0');
                    setTimeout(() => genericInquiryModal.classList.add('hidden'), 300);
                }
            }

            openInquiryModalButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const serviceType = button.dataset.serviceType || 'General Inquiry';
                    openGenericModal(serviceType);
                });
            });

            if (closeGenericInquiryModalBtn) closeGenericInquiryModalBtn.addEventListener('click', closeGenericModal);
            if (genericInquiryModal) genericInquiryModal.addEventListener('click', (event) => {
                if (event.target === genericInquiryModal) closeGenericModal();
            });

            if (genericInquiryForm) {
                genericInquiryForm.addEventListener('submit', (event) => {
                    event.preventDefault();
                    const formData = new FormData(genericInquiryForm);
                    console.log('Generic Inquiry Submitted:', {
                        serviceRequested: formData.get('inquiryServiceName'),
                        name: formData.get('inquiryUserName'),
                        email: formData.get('inquiryUserEmail'),
                        phone: formData.get('inquiryUserPhone'),
                        message: formData.get('inquiryUserMessage'),
                    });
                    alert('Inquiry submitted (check console)!');
                    genericInquiryForm.reset(); 
                    closeGenericModal();
                });
            }

            // Mobile Menu Toggle (from original header, if needed for this page)
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                });
            }

            // --- Favorite Properties Display & Management ---
            const favoritePropertiesContainer = document.getElementById('favoritePropertiesContainer');

            function getFavorites() {
                const userEmail = localStorage.getItem('loggedInUserEmail');
                if (!userEmail) return [];
                const favoritesKey = `favorites_${userEmail}`;
                return JSON.parse(localStorage.getItem(favoritesKey)) || [];
            }

            function saveFavorites(favorites) {
                const userEmail = localStorage.getItem('loggedInUserEmail');
                if (!userEmail) return;
                const favoritesKey = `favorites_${userEmail}`;
                localStorage.setItem(favoritesKey, JSON.stringify(favorites));
            }

            function removeFromFavorites(propertyId) {
                let favorites = getFavorites();
                favorites = favorites.filter(id => id !== propertyId);
                saveFavorites(favorites);
                renderFavoriteProperties(); // Re-render the list
            }

            function renderFavoriteProperties() {
                if (!favoritePropertiesContainer) return;
                const favorites = getFavorites();
                favoritePropertiesContainer.innerHTML = ''; // Clear existing items

                if (favorites.length === 0) {
                    favoritePropertiesContainer.innerHTML = '<p class="text-text-secondary italic">You have no saved favorite properties yet.</p>';
                    return;
                }

                const ul = document.createElement('ul');
                ul.className = 'space-y-4';
                favorites.forEach(propertyId => {
                    const li = document.createElement('li');
                    li.className = 'p-4 bg-white border border-border-light rounded-lg shadow-sm flex justify-between items-center';
                    
                    const propertyName = document.createElement('span');
                    propertyName.textContent = propertyId; // Displaying the ID which contains name and price
                    propertyName.className = 'text-text-primary';

                    const removeBtn = document.createElement('button');
                    removeBtn.textContent = 'Remove';
                    removeBtn.className = 'btn-secondary-outline text-sm px-3 py-1.5 hover:bg-red-500 hover:text-white hover:border-red-500 transition-colors';
                    removeBtn.onclick = () => removeFromFavorites(propertyId);

                    li.appendChild(propertyName);
                    li.appendChild(removeBtn);
                    ul.appendChild(li);
                });
                favoritePropertiesContainer.appendChild(ul);
            }

            // Initial rendering of favorite properties
            if (localStorage.getItem('isUserLoggedIn') === 'true') {
                 renderFavoriteProperties();
            }
            
            // Display user info (existing script)
            const loggedInUserEmail = localStorage.getItem('loggedInUserEmail');
            const loggedInUserName = localStorage.getItem('loggedInUserName');
            const profileUserEmailEl = document.getElementById('profileUserEmail');
            const profileUserNameEl = document.getElementById('profileUserName');

            if (profileUserEmailEl) {
                profileUserEmailEl.textContent = loggedInUserEmail || 'Not logged in';
            }
            if (profileUserNameEl) {
                profileUserNameEl.textContent = loggedInUserName || '-';
            }

            // Placeholder for displaying favorite properties and saved searches
            // This will be expanded in later steps

            // Update copyright year
            const currentYearEl = document.getElementById('currentYear');
            if (currentYearEl) {
                currentYearEl.textContent = new Date().getFullYear();
            }
        });
        // Basic script to redirect if not logged in (can be enhanced)
        if (!localStorage.getItem('isUserLoggedIn')) {
            alert('Please log in to view your profile.');
            window.location.href = 'login.html'; // Redirect immediately if not logged in
        }
    </script>
    <!-- Placeholder for global.js or similar for dynamic header -->

    <!-- Generic Inquiry Modal -->
    <div id="genericInquiryModal" class="fixed inset-0 z-[70] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 hidden transition-opacity duration-300 ease-in-out">
        <div class="bg-white p-6 md:p-8 rounded-xl shadow-2xl w-full max-w-lg transform transition-all duration-300 ease-in-out scale-95 opacity-0" id="genericInquiryModalContent">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-montserrat font-semibold text-primary">Inquiry Form</h2>
                <button id="closeGenericInquiryModalBtn" class="p-2 text-gray-400 hover:text-primary rounded-full hover:bg-gray-100">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <form id="genericInquiryForm">
                <div class="space-y-4">
                    <div>
                        <label for="inquiryServiceName" class="block text-sm font-medium text-text-secondary mb-1">Service Requested</label>
                        <input type="text" id="inquiryServiceName" name="inquiryServiceName" readonly class="input-field w-full bg-gray-100 cursor-not-allowed">
                    </div>
                    <div>
                        <label for="inquiryUserName" class="block text-sm font-medium text-text-secondary mb-1">Full Name</label>
                        <input type="text" id="inquiryUserName" name="inquiryUserName" required class="input-field w-full" placeholder="Your Name">
                    </div>
                    <div>
                        <label for="inquiryUserEmail" class="block text-sm font-medium text-text-secondary mb-1">Email Address</label>
                        <input type="email" id="inquiryUserEmail" name="inquiryUserEmail" required class="input-field w-full" placeholder="you@example.com">
                    </div>
                    <div>
                        <label for="inquiryUserPhone" class="block text-sm font-medium text-text-secondary mb-1">Phone (Optional)</label>
                        <input type="tel" id="inquiryUserPhone" name="inquiryUserPhone" class="input-field w-full" placeholder="(555) 123-4567">
                    </div>
                    <div>
                        <label for="inquiryUserMessage" class="block text-sm font-medium text-text-secondary mb-1">Additional Details/Message</label>
                        <textarea id="inquiryUserMessage" name="inquiryUserMessage" rows="3" class="input-field w-full" placeholder="Any specific requests or questions?"></textarea>
                    </div>
                </div>
                <div class="mt-8 text-right">
                    <button type="submit" id="sendGenericInquiryBtn" class="btn-primary px-8 py-3">Submit Inquiry</button>
                </div>
            </form>
        </div>
    </div>

</body>
</html>
